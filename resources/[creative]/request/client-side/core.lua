-----------------------------------------------------------------------------------------------------------------------------------------
-- VRP
-----------------------------------------------------------------------------------------------------------------------------------------
local Tunnel = module("vrp","lib/Tunnel")
-----------------------------------------------------------------------------------------------------------------------------------------
-- CONNECTION
-----------------------------------------------------------------------------------------------------------------------------------------
Lxp = {}
Tunnel.bindInterface("request",Lxp)
-----------------------------------------------------------------------------------------------------------------------------------------
-- VARIABLES
-----------------------------------------------------------------------------------------------------------------------------------------
local Active = false
local Results = false
local Seconds = GetGameTimer()
-----------------------------------------------------------------------------------------------------------------------------------------
-- SUCESS
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Sucess",function()
	Results = true
	Active = false
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- FAILURE
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterNUICallback("Failure",function()
	Results = false
	Active = false
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- FUNCTION
-----------------------------------------------------------------------------------------------------------------------------------------
function Lxp.Function(Message,Accept,Reject)
	if Active then
		return false
	end

	SendNUIMessage({ Action = "Open", Message = Message, Accept = Accept, Reject = Reject })
	Seconds = GetGameTimer() + 20000
	Active = true

	while Active do
		if GetGameTimer() >= Seconds then
			SendNUIMessage({ Action = "Close" })
			Results = false
			Active = false
		end

		Wait(0)
	end

	return Results
end

exports("Request",function(Message,Accept,Reject)
	if Active then
		return false
	end

	SendNUIMessage({ Action = "Open", Message = Message, Accept = Accept, Reject = Reject })
	Seconds = GetGameTimer() + 20000
	Active = true

	while Active do
		if GetGameTimer() >= Seconds then
			SendNUIMessage({ Action = "Close" })
			Results = false
			Active = false
		end

		Wait(0)
	end

	return Results
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- Y
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand("Y",function()
	if Active then
		SendNUIMessage({ Action = "Y" })
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- U
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterCommand("U",function()
	if Active then
		SendNUIMessage({ Action = "U" })
	end
end)
-----------------------------------------------------------------------------------------------------------------------------------------
-- KEYMAPPING
-----------------------------------------------------------------------------------------------------------------------------------------
RegisterKeyMapping("Y","Aceitar requisições.","keyboard","Y")
RegisterKeyMapping("U","Rejeitar requisições.","keyboard","U")
